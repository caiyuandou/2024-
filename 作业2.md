###第二周课后作业  
视频演示连接：https://www.bilibili.com/video/BV1mMCBYPEVu/  
1.射击命中方块，获得积分X分  
首先我们需要创建一个c++类继承actor，命名为TargetBlock作为我们需要射击的方块  
TargetBlock.cpp  
```
#include "TargetBlock.h"
#include "FPSProjectGameMode.h"
#include "Net/UnrealNetwork.h"

ATargetBlock::ATargetBlock()
{
	PrimaryActorTick.bCanEverTick = false;
    
	UStaticMeshComponent* MeshComp = CreateDefaultSubobject<UStaticMeshComponent>(TEXT("BlockMesh"));
	RootComponent = MeshComp;
    
	MeshComp->SetSimulatePhysics(false);
	MeshComp->SetCollisionEnabled(ECollisionEnabled::QueryAndPhysics);
	MeshComp->OnComponentHit.AddDynamic(this, &ATargetBlock::OnHit);
}
void ATargetBlock::BeginPlay()
{
	Super::BeginPlay();
	
}

void ATargetBlock::OnHit(UPrimitiveComponent* HitComponent, AActor* OtherActor, 
						UPrimitiveComponent* OtherComp, FVector NormalImpulse, 
						const FHitResult& Hit)
{
	if (!bIsHitOnce)
	{
		bIsHitOnce = true;
		FVector NewScale = GetActorScale3D() * ScaleMultiplier;
		SetActorScale3D(NewScale);
        
		AFPSProjectGameMode* GameMode = Cast<AFPSProjectGameMode>(GetWorld()->GetAuthGameMode());
		if (GameMode&&OtherActor)
		{
			AController* InstigatorController=OtherActor->GetInstigatorController();
			int32 FinalScore = bIsSpecialTarget ? ScoreValue * 2 : ScoreValue;
			GameMode->AddScore(InstigatorController, FinalScore);
			
			UE_LOG(LogTemp, Warning, TEXT("Controller: %s, Score: %d"), 
				InstigatorController ? *InstigatorController->GetName() : TEXT("None"), 
				FinalScore);
			if(GEngine)
			{
				FString ScoreMsg=FString::Printf(TEXT("Score: %d"), FinalScore);
				//GEngine->AddOnScreenDebugMessage(-1,2.0f,FColor::Red,ScoreMsg);
			}
		}
	}
	else
	{
		Destroy();
	}
    
	if (OtherActor)
	{
		OtherActor->Destroy(); // 销毁子弹
	}
}
void ATargetBlock::SetSpecialTarget(bool bSpecial)
{
	if (HasAuthority())
	{
		bIsSpecialTarget = bSpecial;
		OnRep_SpecialTarget();
	}
}
void ATargetBlock::GetLifetimeReplicatedProps(TArray<FLifetimeProperty>& OutLifetimeProps) const
{
	Super::GetLifetimeReplicatedProps(OutLifetimeProps);
	DOREPLIFETIME(ATargetBlock, bIsSpecialTarget);
}
void ATargetBlock::OnRep_SpecialTarget()
{
	
}
```
在TargetBlock里面实现OnHit方法实现被击中以后通过SetActorScale3D方法实现缩放，同时调用Gamemode里面的AddStore方法实现添加分数  
2.子弹命中后销毁  
FPSProjectfile.cpp  
```
void AFPSProjectfile::OnHit(UPrimitiveComponent* HitComponent, AActor* OtherActor, UPrimitiveComponent* OtherComponent, FVector NormalImpulse, const
                            FHitResult& Hit)
{
	if(OtherActor!=this)
	{
		OtherComponent->AddImpulseAtLocation(ProjectileMovementComponent->Velocity*100.0f,Hit.ImpactPoint);
		ATargetBlock* TargetBlock=Cast<ATargetBlock>(OtherActor);
		if(TargetBlock)
		{
			
		
			APawn* InstigatorPawn = GetInstigator();
			AController* PlayerController = InstigatorPawn ? InstigatorPawn->GetController() : nullptr;
			
				if(PlayerController)
				{
					TargetBlock->OnHit(HitComponent, this, OtherComponent, NormalImpulse, Hit);
				}
			
		}
	}
	Destroy();
}
```
在FPSProjectile里面添加OnHit逻辑，在击中后执行Destroy方法销毁子弹  






